<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-angular-cli/node_modules/angular-cli/node_modules/@angular/compiler-cli/node_modules/@angular/tsc-wrapped/node_modules/tsickle/build/src/tsickle_compiler_host.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-angular-cli">npmtest-angular-cli (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-angular-cli/node_modules/angular-cli/node_modules/@angular/compiler-cli/node_modules/@angular/tsc-wrapped/node_modules/tsickle/build/src/tsickle_compiler_host.js</span></h1>
    <h2>
        
        Statements: <span class="metric">27.41% <small>(37 / 135)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">6.06% <small>(2 / 33)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">8.33% <small>(2 / 24)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">27.61% <small>(37 / 134)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../../../../../../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-angular-cli/node_modules/angular-cli/node_modules/@angular/compiler-cli/node_modules/@angular/tsc-wrapped/node_modules/tsickle/build/src/</a> &#187; tsickle_compiler_host.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
var path = require('path');
var source_map_1 = require('source-map');
var ts = require('typescript');
var decorator_annotator_1 = require('./decorator-annotator');
var es5processor_1 = require('./es5processor');
var modules_manifest_1 = require('./modules_manifest');
var tsickle_1 = require('./tsickle');
/**
 * Tsickle can perform 2 different precompilation transforms - decorator downleveling
 * and closurization.  Both require tsc to have already type checked their
 * input, so they can't both be run in one call to tsc. If you only want one of
 * the transforms, you can specify it in the constructor, if you want both, you'll
 * have to specify it by calling reconfigureForRun() with the appropriate Pass.
 */
(function (Pass) {
    Pass[Pass["NONE"] = 0] = "NONE";
    Pass[Pass["DECORATOR_DOWNLEVEL"] = 1] = "DECORATOR_DOWNLEVEL";
    Pass[Pass["CLOSURIZE"] = 2] = "CLOSURIZE";
})(exports.Pass || (exports.Pass = {}));
var Pass = exports.Pass;
var ANNOTATION_SUPPORT = "\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n";
/**
 * TsickleCompilerHost does tsickle processing of input files, including
 * closure type annotation processing, decorator downleveling and
 * require -&gt; googmodule rewriting.
 */
var TsickleCompilerHost = (function () {
<span class="fstat-no" title="function not covered" >    function TsickleCompilerHost(delegate, tscOptions, options, environment, runConfiguration) {</span>
<span class="cstat-no" title="statement not covered" >        this.delegate = delegate;</span>
<span class="cstat-no" title="statement not covered" >        this.tscOptions = tscOptions;</span>
<span class="cstat-no" title="statement not covered" >        this.options = options;</span>
<span class="cstat-no" title="statement not covered" >        this.environment = environment;</span>
<span class="cstat-no" title="statement not covered" >        this.runConfiguration = runConfiguration;</span>
        // The manifest of JS modules output by the compiler.
<span class="cstat-no" title="statement not covered" >        this.modulesManifest = new modules_manifest_1.ModulesManifest();</span>
        /** Error messages produced by tsickle, if any. */
<span class="cstat-no" title="statement not covered" >        this.diagnostics = [];</span>
        /** externs.js files produced by tsickle, if any. */
<span class="cstat-no" title="statement not covered" >        this.externs = {};</span>
<span class="cstat-no" title="statement not covered" >        this.decoratorDownlevelSourceMaps = new Map();</span>
<span class="cstat-no" title="statement not covered" >        this.tsickleSourceMaps = new Map();</span>
    }
    /**
     * Tsickle can perform 2 kinds of precompilation source transforms - decorator
     * downleveling and closurization.  They can't be run in the same run of the
     * typescript compiler, because they both depend on type information that comes
     * from running the compiler.  We need to use the same compiler host to run both
     * so we have all the source map data when finally write out.  Thus if we want
     * to run both transforms, we call reconfigureForRun() between the calls to
     * ts.createProgram().
     */
    TsickleCompilerHost.prototype.reconfigureForRun = <span class="fstat-no" title="function not covered" >function (oldProgram, pass) {</span>
<span class="cstat-no" title="statement not covered" >        this.runConfiguration = { oldProgram: oldProgram, pass: pass };</span>
    };
    TsickleCompilerHost.prototype.getSourceFile = <span class="fstat-no" title="function not covered" >function (fileName, languageVersion, onError) {</span>
<span class="cstat-no" title="statement not covered" >        if (this.runConfiguration === undefined || this.runConfiguration.pass === Pass.NONE) {</span>
<span class="cstat-no" title="statement not covered" >            return this.delegate.getSourceFile(fileName, languageVersion, onError);</span>
        }
<span class="cstat-no" title="statement not covered" >        var sourceFile = this.runConfiguration.oldProgram.getSourceFile(fileName);</span>
<span class="cstat-no" title="statement not covered" >        switch (this.runConfiguration.pass) {</span>
            case Pass.DECORATOR_DOWNLEVEL:
<span class="cstat-no" title="statement not covered" >                return this.downlevelDecorators(sourceFile, this.runConfiguration.oldProgram, fileName, languageVersion);</span>
            case Pass.CLOSURIZE:
<span class="cstat-no" title="statement not covered" >                return this.closurize(sourceFile, this.runConfiguration.oldProgram, fileName, languageVersion);</span>
            default:
<span class="cstat-no" title="statement not covered" >                throw new Error('tried to use TsickleCompilerHost with unknown pass enum');</span>
        }
    };
    TsickleCompilerHost.prototype.writeFile = <span class="fstat-no" title="function not covered" >function (fileName, content, writeByteOrderMark, onError, sourceFiles) {</span>
<span class="cstat-no" title="statement not covered" >        if (path.extname(fileName) !== '.map') {</span>
<span class="cstat-no" title="statement not covered" >            fileName = this.delegate.getCanonicalFileName(fileName);</span>
<span class="cstat-no" title="statement not covered" >            if (this.options.googmodule &amp;&amp; !fileName.match(/\.d\.ts$/)) {</span>
<span class="cstat-no" title="statement not covered" >                content = this.convertCommonJsToGoogModule(fileName, content);</span>
            }
        }
        else {
<span class="cstat-no" title="statement not covered" >            content = this.combineSourceMaps(fileName, content);</span>
        }
<span class="cstat-no" title="statement not covered" >        this.delegate.writeFile(fileName, content, writeByteOrderMark, onError, sourceFiles);</span>
    };
    TsickleCompilerHost.prototype.sourceMapConsumerToGenerator = <span class="fstat-no" title="function not covered" >function (sourceMapConsumer) {</span>
<span class="cstat-no" title="statement not covered" >        return source_map_1.SourceMapGenerator.fromSourceMap(sourceMapConsumer);</span>
    };
    /**
     * Tsc identifies source files by their relative path to the output file.  Since
     * there's no easy way to identify these relative paths when tsickle generates its
     * own source maps, we patch them with the file name from the tsc source maps
     * before composing them.
     */
    TsickleCompilerHost.prototype.sourceMapGeneratorToConsumerWithFileName = <span class="fstat-no" title="function not covered" >function (sourceMapGenerator, fileName) {</span>
<span class="cstat-no" title="statement not covered" >        var rawSourceMap = sourceMapGenerator.toJSON();</span>
<span class="cstat-no" title="statement not covered" >        rawSourceMap.sources = [fileName];</span>
<span class="cstat-no" title="statement not covered" >        rawSourceMap.file = fileName;</span>
<span class="cstat-no" title="statement not covered" >        return new source_map_1.SourceMapConsumer(rawSourceMap);</span>
    };
    TsickleCompilerHost.prototype.sourceMapTextToConsumer = <span class="fstat-no" title="function not covered" >function (sourceMapText) {</span>
<span class="cstat-no" title="statement not covered" >        var sourceMapJson = sourceMapText;</span>
<span class="cstat-no" title="statement not covered" >        return new source_map_1.SourceMapConsumer(sourceMapJson);</span>
    };
    TsickleCompilerHost.prototype.getSourceMapKey = <span class="fstat-no" title="function not covered" >function (outputFilePath, sourceFileName) {</span>
<span class="cstat-no" title="statement not covered" >        var fileDir = path.dirname(outputFilePath);</span>
<span class="cstat-no" title="statement not covered" >        return this.getCanonicalFileName(path.resolve(fileDir, sourceFileName));</span>
    };
    TsickleCompilerHost.prototype.combineSourceMaps = <span class="fstat-no" title="function not covered" >function (filePath, tscSourceMapText) {</span>
<span class="cstat-no" title="statement not covered" >        var tscSourceMapConsumer = this.sourceMapTextToConsumer(tscSourceMapText);</span>
<span class="cstat-no" title="statement not covered" >        var tscSourceMapGenerator = this.sourceMapConsumerToGenerator(tscSourceMapConsumer);</span>
<span class="cstat-no" title="statement not covered" >        if (this.tsickleSourceMaps.size &gt; 0) {</span>
            // TODO(lucassloan): remove when the .d.ts has the correct types
<span class="cstat-no" title="statement not covered" >            for (var _i = 0, _a = tscSourceMapConsumer.sources; _i &lt; _a.length; _i++) {</span>
<span class="cstat-no" title="statement not covered" >                var sourceFileName = _a[_i];</span>
<span class="cstat-no" title="statement not covered" >                var sourceMapKey = this.getSourceMapKey(filePath, sourceFileName);</span>
<span class="cstat-no" title="statement not covered" >                var tsickleSourceMapGenerator = this.tsickleSourceMaps.get(sourceMapKey);</span>
<span class="cstat-no" title="statement not covered" >                var tsickleSourceMapConsumer = this.sourceMapGeneratorToConsumerWithFileName(tsickleSourceMapGenerator, sourceFileName);</span>
<span class="cstat-no" title="statement not covered" >                tscSourceMapGenerator.applySourceMap(tsickleSourceMapConsumer);</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        if (this.decoratorDownlevelSourceMaps.size &gt; 0) {</span>
            // TODO(lucassloan): remove when the .d.ts has the correct types
<span class="cstat-no" title="statement not covered" >            for (var _b = 0, _c = tscSourceMapConsumer.sources; _b &lt; _c.length; _b++) {</span>
<span class="cstat-no" title="statement not covered" >                var sourceFileName = _c[_b];</span>
<span class="cstat-no" title="statement not covered" >                var sourceMapKey = this.getSourceMapKey(filePath, sourceFileName);</span>
<span class="cstat-no" title="statement not covered" >                var decoratorDownlevelSourceMapGenerator = this.decoratorDownlevelSourceMaps.get(sourceMapKey);</span>
<span class="cstat-no" title="statement not covered" >                var decoratorDownlevelSourceMapConsumer = this.sourceMapGeneratorToConsumerWithFileName(decoratorDownlevelSourceMapGenerator, sourceFileName);</span>
<span class="cstat-no" title="statement not covered" >                tscSourceMapGenerator.applySourceMap(decoratorDownlevelSourceMapConsumer);</span>
            }
        }
<span class="cstat-no" title="statement not covered" >        return tscSourceMapGenerator.toString();</span>
    };
    TsickleCompilerHost.prototype.convertCommonJsToGoogModule = <span class="fstat-no" title="function not covered" >function (fileName, content) {</span>
<span class="cstat-no" title="statement not covered" >        var moduleId = this.environment.fileNameToModuleId(fileName);</span>
<span class="cstat-no" title="statement not covered" >        var _a = es5processor_1.processES5(fileName, moduleId, content, this.environment.pathToModuleName.bind(this.environment), this.options.es5Mode, this.options.prelude), output = _a.output, referencedModules = _a.referencedModules;</span>
<span class="cstat-no" title="statement not covered" >        var moduleName = this.environment.pathToModuleName('', fileName);</span>
<span class="cstat-no" title="statement not covered" >        this.modulesManifest.addModule(fileName, moduleName);</span>
<span class="cstat-no" title="statement not covered" >        for (var _i = 0, referencedModules_1 = referencedModules; _i &lt; referencedModules_1.length; _i++) {</span>
<span class="cstat-no" title="statement not covered" >            var referenced = referencedModules_1[_i];</span>
<span class="cstat-no" title="statement not covered" >            this.modulesManifest.addReferencedModule(fileName, referenced);</span>
        }
<span class="cstat-no" title="statement not covered" >        return output;</span>
    };
    TsickleCompilerHost.prototype.downlevelDecorators = <span class="fstat-no" title="function not covered" >function (sourceFile, program, fileName, languageVersion) {</span>
<span class="cstat-no" title="statement not covered" >        this.decoratorDownlevelSourceMaps.set(this.getCanonicalFileName(sourceFile.path), new source_map_1.SourceMapGenerator());</span>
<span class="cstat-no" title="statement not covered" >        if (this.environment.shouldSkipTsickleProcessing(fileName))</span>
<span class="cstat-no" title="statement not covered" >            return sourceFile;</span>
<span class="cstat-no" title="statement not covered" >        var fileContent = sourceFile.text;</span>
<span class="cstat-no" title="statement not covered" >        var converted = decorator_annotator_1.convertDecorators(program.getTypeChecker(), sourceFile);</span>
<span class="cstat-no" title="statement not covered" >        if (converted.diagnostics) {</span>
<span class="cstat-no" title="statement not covered" >            (_a = this.diagnostics).push.apply(_a, converted.diagnostics);</span>
        }
<span class="cstat-no" title="statement not covered" >        if (converted.output === fileContent) {</span>
            // No changes; reuse the existing parse.
<span class="cstat-no" title="statement not covered" >            return sourceFile;</span>
        }
<span class="cstat-no" title="statement not covered" >        fileContent = converted.output + ANNOTATION_SUPPORT;</span>
<span class="cstat-no" title="statement not covered" >        this.decoratorDownlevelSourceMaps.set(this.getCanonicalFileName(sourceFile.path), converted.sourceMap);</span>
<span class="cstat-no" title="statement not covered" >        return ts.createSourceFile(fileName, fileContent, languageVersion, true);</span>
<span class="cstat-no" title="statement not covered" >        var _a;</span>
    };
    TsickleCompilerHost.prototype.closurize = <span class="fstat-no" title="function not covered" >function (sourceFile, program, fileName, languageVersion) {</span>
<span class="cstat-no" title="statement not covered" >        this.tsickleSourceMaps.set(this.getCanonicalFileName(sourceFile.path), new source_map_1.SourceMapGenerator());</span>
<span class="cstat-no" title="statement not covered" >        var isDefinitions = /\.d\.ts$/.test(fileName);</span>
        // Don't tsickle-process any d.ts that isn't a compilation target;
        // this means we don't process e.g. lib.d.ts.
<span class="cstat-no" title="statement not covered" >        if (isDefinitions &amp;&amp; this.environment.shouldSkipTsickleProcessing(fileName))</span>
<span class="cstat-no" title="statement not covered" >            return sourceFile;</span>
<span class="cstat-no" title="statement not covered" >        var _a = tsickle_1.annotate(program, sourceFile, this.options, this.delegate, this.tscOptions), output = _a.output, externs = _a.externs, diagnostics = _a.diagnostics, sourceMap = _a.sourceMap;</span>
<span class="cstat-no" title="statement not covered" >        if (externs) {</span>
<span class="cstat-no" title="statement not covered" >            this.externs[fileName] = externs;</span>
        }
<span class="cstat-no" title="statement not covered" >        if (this.environment.shouldIgnoreWarningsForPath(sourceFile.path)) {</span>
            // All diagnostics (including warnings) are treated as errors.
            // If we've decided to ignore them, just discard them.
            // Warnings include stuff like "don't use @type in your jsdoc"; tsickle
            // warns and then fixes up the code to be Closure-compatible anyway.
<span class="cstat-no" title="statement not covered" >            diagnostics = diagnostics.filter(<span class="fstat-no" title="function not covered" >function (d) {</span> <span class="cstat-no" title="statement not covered" >return d.category === ts.DiagnosticCategory.Error; </span>});</span>
        }
<span class="cstat-no" title="statement not covered" >        this.diagnostics = diagnostics;</span>
<span class="cstat-no" title="statement not covered" >        this.tsickleSourceMaps.set(this.getCanonicalFileName(sourceFile.path), sourceMap);</span>
<span class="cstat-no" title="statement not covered" >        return ts.createSourceFile(fileName, output, languageVersion, true);</span>
    };
    /** Concatenate all generated externs definitions together into a string. */
    TsickleCompilerHost.prototype.getGeneratedExterns = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >        var allExterns = '';</span>
<span class="cstat-no" title="statement not covered" >        for (var _i = 0, _a = Object.keys(this.externs); _i &lt; _a.length; _i++) {</span>
<span class="cstat-no" title="statement not covered" >            var fileName = _a[_i];</span>
<span class="cstat-no" title="statement not covered" >            allExterns += "// externs from " + fileName + ":\n";</span>
<span class="cstat-no" title="statement not covered" >            allExterns += this.externs[fileName];</span>
        }
<span class="cstat-no" title="statement not covered" >        return allExterns;</span>
    };
    // Delegate everything else to the original compiler host.
    TsickleCompilerHost.prototype.fileExists = <span class="fstat-no" title="function not covered" >function (fileName) {</span>
<span class="cstat-no" title="statement not covered" >        return this.delegate.fileExists(fileName);</span>
    };
    TsickleCompilerHost.prototype.getCurrentDirectory = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >        return this.delegate.getCurrentDirectory();</span>
    };
    ;
    TsickleCompilerHost.prototype.useCaseSensitiveFileNames = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >        return this.delegate.useCaseSensitiveFileNames();</span>
    };
    TsickleCompilerHost.prototype.getNewLine = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >        return this.delegate.getNewLine();</span>
    };
    TsickleCompilerHost.prototype.getDirectories = <span class="fstat-no" title="function not covered" >function (path) {</span>
<span class="cstat-no" title="statement not covered" >        return this.delegate.getDirectories(path);</span>
    };
    TsickleCompilerHost.prototype.readFile = <span class="fstat-no" title="function not covered" >function (fileName) {</span>
<span class="cstat-no" title="statement not covered" >        return this.delegate.readFile(fileName);</span>
    };
    TsickleCompilerHost.prototype.getDefaultLibFileName = <span class="fstat-no" title="function not covered" >function (options) {</span>
<span class="cstat-no" title="statement not covered" >        return this.delegate.getDefaultLibFileName(options);</span>
    };
    TsickleCompilerHost.prototype.getCanonicalFileName = <span class="fstat-no" title="function not covered" >function (fileName) {</span>
<span class="cstat-no" title="statement not covered" >        return this.delegate.getCanonicalFileName(fileName);</span>
    };
    return TsickleCompilerHost;
}());
exports.TsickleCompilerHost = TsickleCompilerHost;
&nbsp;
//# sourceMappingURL=tsickle_compiler_host.js.map
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Mon Apr 17 2017 11:40:16 GMT+0000 (UTC)</div>
</div>
</body>
</html>
